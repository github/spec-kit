---
description: インタラクティブまたは提供された原則の入力からプロジェクト憲章を作成または更新し、すべての依存テンプレートの同期を確実にします。
---

ユーザー入力は、エージェントから直接提供されるか、コマンド引数として提供されます - プロンプトに進む前に、（空でない場合は）**必ず**考慮してください。

ユーザー入力:

$ARGUMENTS

`/memory/constitution.md`のプロジェクト憲章を更新しています。このファイルは、角括弧内にプレースホルダートークンを含むTEMPLATE（例：`[PROJECT_NAME]`, `[PRINCIPLE_1_NAME]`）です。あなたの役割は、(a) 具体的な値を収集/導出し、(b) テンプレートを正確に埋め、(c) 依存アーティファクト全体に修正を伝播することです。

次の実行フローに従ってください：

1. `/memory/constitution.md`の既存の憲章テンプレートを読み込みます。
   - `[ALL_CAPS_IDENTIFIER]`形式のプレースホルダートークンをすべて特定します。
   **重要**: ユーザーはテンプレートで使用されているものより少ないまたは多い原則を必要とする場合があります。数が指定されている場合は、それを尊重し - 一般的なテンプレートに従ってください。それに応じてドキュメントを更新します。

2. プレースホルダーの値を収集/導出します：
   - ユーザー入力（会話）が値を提供している場合は、それを使用します。
   - そうでなければ、既存のリポジトリコンテキスト（README、ドキュメント、埋め込まれている場合は以前の憲章バージョン）から推測します。
   - ガバナンス日付について：`RATIFICATION_DATE`は元の採用日（不明な場合は質問するかTODOとしてマーク）、`LAST_AMENDED_DATE`は変更が行われた場合は今日、そうでなければ以前のものを保持します。
   - `CONSTITUTION_VERSION`はセマンティックバージョニングルールに従って増分する必要があります：
     * MAJOR: 後方互換性のないガバナンス/原則の削除または再定義。
     * MINOR: 新しい原則/セクションの追加または実質的に拡張されたガイダンス。
     * PATCH: 明確化、文言修正、タイポ修正、非セマンティックな改良。
   - バージョンバンプタイプが曖昧な場合は、確定前に理由を提案します。

3. 更新された憲章コンテンツを下書きします：
   - すべてのプレースホルダーを具体的なテキストで置換します（プロジェクトがまだ定義しないことを選択した意図的に保持されたテンプレートスロットを除き、角括弧トークンは残さない—残されたものはすべて明示的に正当化してください）。
   - 見出し階層を保持し、コメントは置換後に明確化ガイダンスを追加しない限り削除できます。
   - 各原則セクションを確実にします：簡潔な名前行、交渉不可能なルールを捉える段落（または箇条書き）、明らかでない場合は明示的な根拠。
   - ガバナンスセクションが修正手順、バージョニングポリシー、コンプライアンスレビューの期待を列挙することを確実にします。

4. 一貫性伝播チェックリスト（以前のチェックリストをアクティブな検証に変換）：
   - `/templates/plan-template.md`を読み、「憲章チェック」またはルールが更新された原則と一致することを確認します。
   - `/templates/spec-template.md`でスコープ/要件の整合性を確認—憲章が必須セクションや制約を追加/削除する場合は更新します。
   - `/templates/tasks-template.md`を読み、タスク分類が新しいまたは削除された原則駆動のタスクタイプ（例：可観測性、バージョニング、テスト規律）を反映することを確実にします。
   - `/templates/commands/*.md`内の各コマンドファイル（これを含む）を読み、一般的なガイダンスが必要な場合に古い参照（CLAUDEのようなエージェント固有の名前のみ）が残っていないことを確認します。
   - ランタイムガイダンスドキュメント（例：`README.md`、`docs/quickstart.md`、またはエージェント固有のガイダンスファイルが存在する場合）を読みます。変更された原則への参照を更新します。

5. 同期影響レポートを作成します（更新後に憲章ファイルの上部にHTMLコメントとして付加）：
   - バージョン変更：古い → 新しい
   - 修正された原則のリスト（名前変更された場合は古いタイトル → 新しいタイトル）
   - 追加されたセクション
   - 削除されたセクション
   - 更新が必要なテンプレート（✅ 更新済み / ⚠ 保留中）とファイルパス
   - プレースホルダーが意図的に延期された場合のフォローアップTODO。

6. 最終出力前の検証：
   - 説明されていない角括弧トークンが残っていないこと。
   - バージョン行がレポートと一致すること。
   - 日付がISO形式YYYY-MM-DDであること。
   - 原則が宣言的で、テスト可能で、曖昧な言語がないこと（「should」→ 適切な場合はMUST/SHOULDの根拠で置換）。

7. 完成した憲章を`/memory/constitution.md`に書き戻します（上書き）。

8. ユーザーに最終要約を出力します：
   - 新しいバージョンとバンプの根拠。
   - 手動フォローアップにフラグが立てられたファイル。
   - 提案されたコミットメッセージ（例：`docs: amend constitution to vX.Y.Z (principle additions + governance update)`）。

フォーマットとスタイル要件：
- テンプレートと同じようにMarkdown見出しを使用します（レベルを降格/昇格しない）。
- 読みやすさを保つために長い根拠行を折り返します（理想的には100文字未満）が、不自然な改行で厳密に強制しない。
- セクション間に単一の空行を保持します。
- 末尾の空白を避けます。

ユーザーが部分的な更新（例：原則の1つの修正のみ）を提供した場合でも、検証とバージョン決定ステップを実行します。

重要な情報が不足している場合（例：批准日が本当に不明）、`TODO(<FIELD_NAME>): explanation`を挿入し、延期項目の下で同期影響レポートに含めます。

新しいテンプレートを作成せず、常に既存の`/memory/constitution.md`ファイルで操作してください。

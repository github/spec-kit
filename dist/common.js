(self.webpackChunkspec_kit_azure_devops_extension=self.webpackChunkspec_kit_azure_devops_extension||[]).push([[76],{616:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RepositoryService=void 0,t.RepositoryService=class{constructor(){this.seedAssets={prompts:[".github/prompts/specify.md",".github/prompts/plan.md",".github/prompts/tasks.md",".github/prompts/constitution.md"],config:[".specify/config.yml",".specify/templates/user-story.md",".specify/templates/feature.md",".specify/guardrails/security.yml",".specify/guardrails/performance.yml"]}}async isRepositorySeeded(e){try{return(await this.getRepositoryStatus(e)).isSeeded}catch(e){return console.error("Error checking repository seed status:",e),!1}}async getRepositoryStatus(e){return{isSeeded:!1,specKitVersion:void 0,lastSeededDate:void 0,configFiles:[]}}async seedRepository(e,t){try{const n=t||await this.getDefaultRepository(e),r=`spec-kit-seed-${Date.now()}`;await this.createBranch(n,r);const o=[];for(const e of this.seedAssets.prompts){const t=await this.getPromptTemplate(e);await this.addFile(n,r,e,t),o.push(e)}for(const e of this.seedAssets.config){const t=await this.getConfigTemplate(e);await this.addFile(n,r,e,t),o.push(e)}return{success:!0,prUrl:await this.createPullRequest(n,r,"main","Add Spec Kit Configuration","This PR adds Spec Kit configuration files and prompt templates to enable AI-powered specification workflows."),branchName:r,filesAdded:o}}catch(e){return{success:!1,error:e instanceof Error?e.message:String(e)}}}async getDefaultRepository(e){return"default-repo-id"}async createBranch(e,t){console.log(`Creating branch ${t} in repository ${e}`)}async addFile(e,t,n,r){console.log(`Adding file ${n} to branch ${t}`)}async createPullRequest(e,t,n,r,o){return`https://dev.azure.com/organization/project/_git/repo/pullrequest/${Math.floor(1e3*Math.random())+1}`}async getPromptTemplate(e){return{".github/prompts/specify.md":"# Specification Prompt Template\n\n## Context\nYou are helping to generate detailed specifications for software features.\n\n## Instructions\n1. Analyze the work item requirements\n2. Consider the project constitution and guidelines\n3. Generate comprehensive specifications including:\n   - Functional requirements\n   - Non-functional requirements\n   - Acceptance criteria\n   - Dependencies\n   - Risk considerations\n\n## Output Format\nGenerate specifications in markdown format with clear sections and detailed explanations.",".github/prompts/plan.md":"# Planning Prompt Template\n\n## Context\nYou are creating implementation plans based on specifications.\n\n## Instructions\n1. Review the specification document\n2. Break down into implementation phases\n3. Identify dependencies and prerequisites\n4. Estimate effort and timelines\n5. Consider technical risks and mitigation strategies\n\n## Output Format\nCreate a structured implementation plan with phases, tasks, and timelines.",".github/prompts/tasks.md":"# Task Generation Prompt Template\n\n## Context\nYou are breaking down implementation plans into actionable tasks.\n\n## Instructions\n1. Analyze the implementation plan\n2. Create specific, actionable tasks\n3. Include effort estimates (in hours/story points)\n4. Define clear acceptance criteria for each task\n5. Identify task dependencies\n\n## Output Format\nGenerate tasks in a structured format suitable for Azure DevOps work items.",".github/prompts/constitution.md":"# Project Constitution\n\n## Coding Standards\n- Follow team coding conventions\n- Use consistent naming patterns\n- Include comprehensive error handling\n- Write meaningful comments and documentation\n\n## Quality Guidelines\n- All code must have unit tests\n- Minimum 80% code coverage\n- Peer review required for all changes\n- Automated testing in CI/CD pipeline\n\n## Architecture Principles\n- Follow SOLID principles\n- Use dependency injection\n- Implement proper logging\n- Consider security implications\n\n## Non-Functional Requirements\n- Performance: Page load times < 2 seconds\n- Security: All inputs must be validated\n- Accessibility: WCAG 2.1 compliance\n- Scalability: Support 10,000 concurrent users"}[e]||`# ${e}\n\nTemplate content for ${e}`}async getConfigTemplate(e){return{".specify/config.yml":'# Spec Kit Configuration\nversion: "1.0"\n\n# Default settings\ndefaults:\n  temperature: 0.7\n  max_tokens: 2000\n  output_format: "markdown"\n\n# Workflow settings\nworkflows:\n  specify:\n    enabled: true\n    auto_save: true\n    output_location: "specs/"\n  \n  plan:\n    enabled: true\n    auto_save: true\n    output_location: "plans/"\n  \n  tasks:\n    enabled: true\n    auto_create_work_items: true\n    task_prefix: "TASK"\n\n# Integration settings\nintegrations:\n  azure_devops:\n    auto_link_work_items: true\n    sync_state_changes: true\n  \n  wiki:\n    auto_publish: false\n    wiki_path: "Specifications/"',".specify/templates/user-story.md":"# User Story Template\n\n## Title\n{{title}}\n\n## Description\n{{description}}\n\n## Acceptance Criteria\n{{acceptanceCriteria}}\n\n## Specification\n\n### Functional Requirements\n[Generated specifications will appear here]\n\n### Non-Functional Requirements\n[Performance, security, and other non-functional requirements]\n\n### Dependencies\n[External dependencies and prerequisites]\n\n### Risk Assessment\n[Potential risks and mitigation strategies]",".specify/templates/feature.md":"# Feature Template\n\n## Feature: {{title}}\n\n### Overview\n{{description}}\n\n### User Stories\n{{acceptanceCriteria}}\n\n### Technical Specification\n\n#### Architecture\n[High-level architecture description]\n\n#### Components\n[Detailed component breakdown]\n\n#### Data Model\n[Data structures and relationships]\n\n#### API Specification\n[API endpoints and contracts]\n\n#### Security Considerations\n[Security requirements and implementation]",".specify/guardrails/security.yml":'# Security Guardrails\n\nrules:\n  - name: "Input Validation"\n    description: "All user inputs must be validated"\n    severity: "high"\n    pattern: "validate.*input|sanitize.*data"\n    \n  - name: "Authentication Required"\n    description: "Protected endpoints must require authentication"\n    severity: "high"\n    pattern: "authenticate|authorize"\n    \n  - name: "SQL Injection Prevention"\n    description: "Use parameterized queries"\n    severity: "critical"\n    pattern: "parameterized|prepared.*statement"\n    \n  - name: "XSS Prevention"\n    description: "Escape output data"\n    severity: "high"\n    pattern: "escape.*output|sanitize.*html"',".specify/guardrails/performance.yml":'# Performance Guardrails\n\nrules:\n  - name: "Database Query Optimization"\n    description: "Optimize database queries for performance"\n    severity: "medium"\n    pattern: "index|optimize.*query"\n    \n  - name: "Caching Strategy"\n    description: "Implement appropriate caching"\n    severity: "medium"\n    pattern: "cache|memoize"\n    \n  - name: "Async Operations"\n    description: "Use async/await for I/O operations"\n    severity: "low"\n    pattern: "async|await"\n    \n  - name: "Resource Management"\n    description: "Proper resource cleanup"\n    severity: "medium"\n    pattern: "dispose|close|cleanup"'}[e]||`# ${e}\n\nConfiguration template for ${e}`}async saveArtifact(e,t,n,r){console.log(`Saving artifact ${t} with message: ${r}`)}async getArtifacts(e,t){return[`${t}/example.md`]}}},635:(e,t,n)=>{"use strict";n.r(t),n.d(t,{__addDisposableResource:()=>A,__assign:()=>i,__asyncDelegator:()=>S,__asyncGenerator:()=>I,__asyncValues:()=>O,__await:()=>C,__awaiter:()=>h,__classPrivateFieldGet:()=>T,__classPrivateFieldIn:()=>M,__classPrivateFieldSet:()=>R,__createBinding:()=>y,__decorate:()=>a,__disposeResources:()=>z,__esDecorate:()=>u,__exportStar:()=>g,__extends:()=>o,__generator:()=>m,__importDefault:()=>D,__importStar:()=>P,__makeTemplateObject:()=>j,__metadata:()=>f,__param:()=>c,__propKey:()=>p,__read:()=>v,__rest:()=>s,__runInitializers:()=>l,__setFunctionName:()=>d,__spread:()=>_,__spreadArray:()=>k,__spreadArrays:()=>b,__values:()=>w,default:()=>$});var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var i=function(){return i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},i.apply(this,arguments)};function s(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}function a(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s}function c(e,t){return function(n,r){t(n,r,e)}}function u(e,t,n,r,o,i){function s(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var a,c=r.kind,u="getter"===c?"get":"setter"===c?"set":"value",l=!t&&e?r.static?e:e.prototype:null,p=t||(l?Object.getOwnPropertyDescriptor(l,r.name):{}),d=!1,f=n.length-1;f>=0;f--){var h={};for(var m in r)h[m]="access"===m?{}:r[m];for(var m in r.access)h.access[m]=r.access[m];h.addInitializer=function(e){if(d)throw new TypeError("Cannot add initializers after decoration has completed");i.push(s(e||null))};var y=(0,n[f])("accessor"===c?{get:p.get,set:p.set}:p[u],h);if("accessor"===c){if(void 0===y)continue;if(null===y||"object"!=typeof y)throw new TypeError("Object expected");(a=s(y.get))&&(p.get=a),(a=s(y.set))&&(p.set=a),(a=s(y.init))&&o.unshift(a)}else(a=s(y))&&("field"===c?o.unshift(a):p[u]=a)}l&&Object.defineProperty(l,r.name,p),d=!0}function l(e,t,n){for(var r=arguments.length>2,o=0;o<t.length;o++)n=r?t[o].call(e,n):t[o].call(e);return r?n:void 0}function p(e){return"symbol"==typeof e?e:"".concat(e)}function d(e,t,n){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})}function f(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function h(e,t,n,r){return new(n||(n=Promise))(function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(s,a)}c((r=r.apply(e,t||[])).next())})}function m(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){s.label=a[1];break}if(6===a[0]&&s.label<o[1]){s.label=o[1],o=a;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(a);break}o[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}var y=Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]};function g(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||y(t,e,n)}function w(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function v(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s}function _(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(v(arguments[t]));return e}function b(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,o++)r[o]=i[s];return r}function k(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}function C(e){return this instanceof C?(this.v=e,this):new C(e)}function I(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,o=n.apply(e,t||[]),i=[];return r={},s("next"),s("throw"),s("return",function(e){return function(t){return Promise.resolve(t).then(e,u)}}),r[Symbol.asyncIterator]=function(){return this},r;function s(e,t){o[e]&&(r[e]=function(t){return new Promise(function(n,r){i.push([e,t,n,r])>1||a(e,t)})},t&&(r[e]=t(r[e])))}function a(e,t){try{(n=o[e](t)).value instanceof C?Promise.resolve(n.value.v).then(c,u):l(i[0][2],n)}catch(e){l(i[0][3],e)}var n}function c(e){a("next",e)}function u(e){a("throw",e)}function l(e,t){e(t),i.shift(),i.length&&a(i[0][0],i[0][1])}}function S(e){var t,n;return t={},r("next"),r("throw",function(e){throw e}),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,o){t[r]=e[r]?function(t){return(n=!n)?{value:C(e[r](t)),done:!1}:o?o(t):t}:o}}function O(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=w(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise(function(r,o){!function(e,t,n,r){Promise.resolve(r).then(function(t){e({value:t,done:n})},t)}(r,o,(t=e[n](t)).done,t.value)})}}}function j(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var x=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function P(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&y(t,e,n);return x(t,e),t}function D(e){return e&&e.__esModule?e:{default:e}}function T(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)}function R(e,t,n,r,o){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?o.call(e,n):o?o.value=n:t.set(e,n),n}function M(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function A(e,t,n){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var r,o;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(void 0===r){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose],n&&(o=r)}if("function"!=typeof r)throw new TypeError("Object not disposable.");o&&(r=function(){try{o.call(this)}catch(e){return Promise.reject(e)}}),e.stack.push({value:t,dispose:r,async:n})}else n&&e.stack.push({async:!0});return t}var E="function"==typeof SuppressedError?SuppressedError:function(e,t,n){var r=new Error(n);return r.name="SuppressedError",r.error=e,r.suppressed=t,r};function z(e){function t(t){e.error=e.hasError?new E(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}return function n(){for(;e.stack.length;){var r=e.stack.pop();try{var o=r.dispose&&r.dispose.call(r.value);if(r.async)return Promise.resolve(o).then(n,function(e){return t(e),n()})}catch(e){t(e)}}if(e.hasError)throw e.error}()}const $={__extends:o,__assign:i,__rest:s,__decorate:a,__param:c,__metadata:f,__awaiter:h,__generator:m,__createBinding:y,__exportStar:g,__values:w,__read:v,__spread:_,__spreadArrays:b,__spreadArray:k,__await:C,__asyncGenerator:I,__asyncDelegator:S,__asyncValues:O,__makeTemplateObject:j,__importStar:P,__importDefault:D,__classPrivateFieldGet:T,__classPrivateFieldSet:R,__classPrivateFieldIn:M,__addDisposableResource:A,__disposeResources:z}},661:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LLMService=void 0,t.LLMService=class{constructor(){this.connectionCache=new Map}async getProjectConnections(e){if(this.connectionCache.has(e))return this.connectionCache.get(e);const t=await this.fetchServiceConnections(e);return this.connectionCache.set(e,t),t}async fetchServiceConnections(e){return[{id:"openai-connection-1",name:"OpenAI GPT-4",baseUrl:"https://api.openai.com/v1",model:"gpt-4",temperatureCap:.7,isDefault:!0,isActive:!0,createdDate:new Date("2024-01-15"),lastTestDate:new Date("2024-01-20")},{id:"azure-openai-connection-1",name:"Azure OpenAI",baseUrl:"https://my-resource.openai.azure.com",model:"gpt-4",region:"East US",temperatureCap:.5,isDefault:!1,isActive:!0,createdDate:new Date("2024-01-10")}]}async testConnection(e){const t=Date.now();try{const n=await this.getConnectionById(e);if(!n)throw new Error("Connection not found");const r=await this.makeTestCall(n),o=Date.now()-t;return{success:!0,model:r.model,latency:o}}catch(e){return{success:!1,error:e instanceof Error?e.message:String(e)}}}async getConnectionById(e){return{id:e,name:"Test Connection",baseUrl:"https://api.openai.com/v1",model:"gpt-4",isDefault:!1,isActive:!0,createdDate:new Date}}async makeTestCall(e){return{model:e.model,response:"Test successful"}}async setDefaultConnection(e,t){const n=await this.getProjectConnections(e);n.forEach(e=>{e.isDefault=e.id===t}),console.log(`Setting default LLM connection to ${t} for project ${e}`),this.connectionCache.set(e,n)}async executePrompt(e,t,n){const r=await this.getConnectionById(e);if(!r)throw new Error("LLM connection not found");const o=Math.ceil(t.length/4),i=Math.ceil(1e3*Math.random()+200);return{response:`Mock response to: ${t.substring(0,50)}...`,cost:this.calculateCost(r.model,o,i),tokens:{input:o,output:i}}}calculateCost(e,t,n){const r={"gpt-4":{input:.03/1e3,output:.06/1e3},"gpt-3.5-turbo":{input:1e-6,output:2e-6},"claude-3":{input:.015/1e3,output:75e-6}},o=r[e]||r["gpt-4"];return t*o.input+n*o.output}clearCache(){this.connectionCache.clear()}}},677:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryService=void 0,t.TelemetryService=class{constructor(){this.metricsCache=new Map,this.runsCache=new Map}async recordWorkflowStart(e,t){const n=this.generateRunId(),r={...t,id:n,timestamp:new Date,status:"running"},o=this.runsCache.get(e)||[];return o.unshift(r),this.runsCache.set(e,o.slice(0,100)),await this.recordAuditEntry({runId:n,action:"workflow_started",details:{workflow:t.workflow,workItemId:t.workItemId},userId:await this.getCurrentUserId(),projectId:e}),console.log(`Recorded workflow start: ${n}`),n}async recordWorkflowCompletion(e,t,n){const r=this.runsCache.get(t)||[],o=r.findIndex(t=>t.id===e);o>=0&&(r[o]={...r[o],status:n.status,duration:n.duration,cost:n.cost,tokens:n.tokens,errorMessage:n.errorMessage,artifacts:n.artifacts},this.runsCache.set(t,r)),await this.recordAuditEntry({runId:e,action:"workflow_completed",details:n,userId:await this.getCurrentUserId(),projectId:t}),this.metricsCache.delete(t),console.log(`Recorded workflow completion: ${e}`)}async getProjectMetrics(e){if(this.metricsCache.has(e))return this.metricsCache.get(e);const t=await this.getRecentRuns(e,1e3),n=this.calculateMetrics(t);return this.metricsCache.set(e,n),n}calculateMetrics(e){const t=e.filter(e=>"success"===e.status),n=e.length,r=n>0?t.length/n:0,o=t.reduce((e,t)=>e+(t.cost||0),0);return{totalRuns:n,successRate:r,avgCost:t.length>0?o/t.length:0,avgDuration:t.length>0?t.reduce((e,t)=>e+(t.duration||0),0)/t.length:0,workflowBreakdown:{specify:e.filter(e=>"specify"===e.workflow).length,plan:e.filter(e=>"plan"===e.workflow).length,tasks:e.filter(e=>"tasks"===e.workflow).length},costBreakdown:{total:o,byWorkflow:{specify:t.filter(e=>"specify"===e.workflow).reduce((e,t)=>e+(t.cost||0),0),plan:t.filter(e=>"plan"===e.workflow).reduce((e,t)=>e+(t.cost||0),0),tasks:t.filter(e=>"tasks"===e.workflow).reduce((e,t)=>e+(t.cost||0),0)},byMonth:this.calculateMonthlyCosts(t)},leadTimeMetrics:{avgSpecifyToMerge:48,avgPlanToImplementation:24,avgTasksToCompletion:72}}}calculateMonthlyCosts(e){const t={};return e.forEach(e=>{if(e.cost){const n=e.timestamp.toISOString().slice(0,7);t[n]=(t[n]||0)+e.cost}}),Object.entries(t).map(([e,t])=>({month:e,cost:t})).sort((e,t)=>e.month.localeCompare(t.month))}async getRecentRuns(e,t=10){const n=this.runsCache.get(e);if(n)return n.slice(0,t);const r=[{id:"run_1",timestamp:new Date(Date.now()-18e5),workflow:"specify",workItemId:12345,workItemTitle:"User authentication system",status:"success",duration:25e3,cost:.05,tokens:{input:1200,output:800},llmModel:"gpt-4"},{id:"run_2",timestamp:new Date(Date.now()-72e5),workflow:"plan",workItemId:12346,workItemTitle:"Payment processing module",status:"success",duration:18e3,cost:.03,tokens:{input:800,output:600},llmModel:"gpt-4"},{id:"run_3",timestamp:new Date(Date.now()-144e5),workflow:"tasks",workItemId:12347,workItemTitle:"Data validation framework",status:"failed",duration:5e3,errorMessage:"LLM connection timeout",llmModel:"gpt-4"}];return this.runsCache.set(e,r),r.slice(0,t)}async getRunDetails(e){for(const t of this.runsCache.values()){const n=t.find(t=>t.id===e);if(n)return n}return null}async recordAuditEntry(e){const t={...e,id:this.generateAuditId(),timestamp:new Date};console.log("Audit entry:",t)}async getCurrentUserId(){return"current-user-id"}generateRunId(){return`run_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}generateAuditId(){return`audit_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}async exportMetrics(e,t){const n=await this.getProjectMetrics(e),r=await this.getRecentRuns(e,1e3);if("json"===t)return JSON.stringify({metrics:n,runs:r},null,2);{let e="Timestamp,Workflow,WorkItemId,Status,Duration,Cost,Tokens\n";return r.forEach(t=>{e+=`${t.timestamp.toISOString()},${t.workflow},${t.workItemId},${t.status},${t.duration||""},${t.cost||""},${t.tokens?`${t.tokens.input}/${t.tokens.output}`:""}\n`}),e}}clearCache(){this.metricsCache.clear(),this.runsCache.clear()}}},792:(e,t,n)=>{var r,o;r=[t,n(635)],o=function(e,t){"use strict";var n=parseInt("10000000000",36),r=Number.MAX_SAFE_INTEGER||9007199254740991,o=function(){function e(){this.objects={}}return e.prototype.register=function(e,t){this.objects[e]=t},e.prototype.unregister=function(e){delete this.objects[e]},e.prototype.getInstance=function(e,t){var n=this.objects[e];if(n)return"function"==typeof n?n(t):n},e}(),i=1,s=function(){function e(e,t){this.promises={},this.nextMessageId=1,this.nextProxyId=1,this.proxyFunctions={},this.postToWindow=e,this.targetOrigin=t,this.registry=new o,this.channelId=i++,this.targetOrigin||(this.handshakeToken=Math.floor(Math.random()*(r-n)+n).toString(36)+Math.floor(Math.random()*(r-n)+n).toString(36))}return e.prototype.getObjectRegistry=function(){return this.registry},e.prototype.invokeRemoteMethod=function(e,n,r,o,i){return t.__awaiter(this,void 0,void 0,function(){var s,a,c=this;return t.__generator(this,function(t){return s={id:this.nextMessageId++,methodName:e,instanceId:n,instanceContext:o,params:this._customSerializeObject(r,i),serializationSettings:i},this.targetOrigin||(s.handshakeToken=this.handshakeToken),a=new Promise(function(e,t){c.promises[s.id]={resolve:e,reject:t}}),this._sendRpcMessage(s),[2,a]})})},e.prototype.getRemoteObjectProxy=function(e,t){return this.invokeRemoteMethod("",e,void 0,t)},e.prototype.invokeMethod=function(e,t){var n=this;if(t.methodName){var r=e[t.methodName];if("function"==typeof r)try{var o=[];t.params&&(o=this._customDeserializeObject(t.params,{}));var i=r.apply(e,o);i&&i.then&&"function"==typeof i.then?i.then(function(e){n._success(t,e,t.handshakeToken)},function(e){n.error(t,e)}):this._success(t,i,t.handshakeToken)}catch(e){this.error(t,e)}else this.error(t,new Error("RPC method not found: "+t.methodName))}else this._success(t,e,t.handshakeToken)},e.prototype.getRegisteredObject=function(e,t){if("__proxyFunctions"===e)return this.proxyFunctions;var n=this.registry.getInstance(e,t);return n||(n=c.getInstance(e,t)),n},e.prototype.onMessage=function(e){var t=this;if(e.instanceId){var n=this.getRegisteredObject(e.instanceId,e.instanceContext);if(!n)return!1;"function"==typeof n.then?n.then(function(n){t.invokeMethod(n,e)},function(n){t.error(e,n)}):this.invokeMethod(n,e)}else{var r=this.promises[e.id];if(!r)return!1;e.error?r.reject(this._customDeserializeObject([e.error],{})[0]):r.resolve(this._customDeserializeObject([e.result],{})[0]),delete this.promises[e.id]}return!0},e.prototype.owns=function(e,t,n){if(this.postToWindow===e){if(this.targetOrigin)return!!t&&("null"===t.toLowerCase()||0===this.targetOrigin.toLowerCase().indexOf(t.toLowerCase()));if(n.handshakeToken&&n.handshakeToken===this.handshakeToken)return this.targetOrigin=t,!0}return!1},e.prototype.error=function(e,t){this._sendRpcMessage({id:e.id,error:this._customSerializeObject([t],e.serializationSettings)[0],handshakeToken:e.handshakeToken})},e.prototype._success=function(e,t,n){this._sendRpcMessage({id:e.id,result:this._customSerializeObject([t],e.serializationSettings)[0],handshakeToken:n})},e.prototype._sendRpcMessage=function(e){this.postToWindow.postMessage(JSON.stringify(e),"*")},e.prototype._customSerializeObject=function(e,t,n,r,o){var i=this;if(void 0===r&&(r=1),void 0===o&&(o=1),e&&!(o>100)&&!(e instanceof Node||e instanceof Window||e instanceof Event)){var s,a;(a=n||{newObjects:[],originalObjects:[]}).originalObjects.push(e);var c=function(n,s,c){var u;try{u=n[c]}catch(e){}var l=typeof u;if("undefined"!==l){var p=-1;if("object"===l&&(p=a.originalObjects.indexOf(u)),p>=0){var d=a.newObjects[p];d.__circularReferenceId||(d.__circularReferenceId=r++),s[c]={__circularReference:d.__circularReferenceId}}else"function"===l?(i.nextProxyId++,s[c]={__proxyFunctionId:i._registerProxyFunction(u,e),_channelId:i.channelId}):"object"===l?u&&u instanceof Date?s[c]={__proxyDate:u.getTime()}:s[c]=i._customSerializeObject(u,t,a,r,o+1):"__proxyFunctionId"!==c&&(s[c]=u)}};if(e instanceof Array){s=[],a.newObjects.push(s);for(var u=0,l=e.length;u<l;u++)c(e,s,u)}else{s={},a.newObjects.push(s);var p={};try{p=function(e){for(var t={};e&&e!==Object.prototype;){for(var n=0,r=Object.getOwnPropertyNames(e);n<r.length;n++){var o=r[n];"constructor"!==o&&(t[o]=!0)}e=Object.getPrototypeOf(e)}return t}(e)}catch(e){}for(var d in p)(d&&"_"!==d[0]||t&&t.includeUnderscoreProperties)&&c(e,s,d)}return a.originalObjects.pop(),a.newObjects.pop(),s}},e.prototype._registerProxyFunction=function(e,t){var n=this.nextProxyId++;return this.proxyFunctions["proxy"+n]=function(){return e.apply(t,Array.prototype.slice.call(arguments,0))},n},e.prototype._customDeserializeObject=function(e,t){var n=this,r=this;if(!e)return null;var o=function(e,o){var i=e[o],s=typeof i;"__circularReferenceId"===o&&"number"===s?(t[i]=e,delete e[o]):"object"===s&&i&&(i.__proxyFunctionId?e[o]=function(){return r.invokeRemoteMethod("proxy"+i.__proxyFunctionId,"__proxyFunctions",Array.prototype.slice.call(arguments,0),{},{includeUnderscoreProperties:!0})}:i.__proxyDate?e[o]=new Date(i.__proxyDate):i.__circularReference?e[o]=t[i.__circularReference]:n._customDeserializeObject(i,t))};if(e instanceof Array)for(var i=0,s=e.length;i<s;i++)o(e,i);else if("object"==typeof e)for(var a in e)o(e,a);return e},e}(),a=function(){function e(){var e=this;this._channels=[],this._handleMessageReceived=function(t){var n;if("string"==typeof t.data)try{n=JSON.parse(t.data)}catch(e){}if(n){for(var r=!1,o=void 0,i=0,s=e._channels;i<s.length;i++){var a=s[i];a.owns(t.source,t.origin,n)&&(o=a,r=a.onMessage(n)||r)}o&&!r&&(window.console&&console.error("No handler found on any channel for message: ".concat(JSON.stringify(n))),n.instanceId&&o.error(n,new Error("The registered object ".concat(n.instanceId," could not be found."))))}},window.addEventListener("message",this._handleMessageReceived)}return e.prototype.addChannel=function(e,t){var n=new s(e,t);return this._channels.push(n),n},e.prototype.removeChannel=function(e){this._channels=this._channels.filter(function(t){return t!==e})},e}(),c=new o,u=new a;e.XDMChannel=s,e.XDMObjectRegistry=o,e.channelManager=u,e.globalObjectRegistry=c}.apply(t,r),void 0===o||(e.exports=o)},844:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SpecKitOrchestrator=void 0,t.SpecKitOrchestrator=class{constructor(){this.activeRuns=new Map}async startWorkflow(e,t,n,r){const o=this.generateRunId(),i={workItemId:t,projectId:n,workflow:e,options:r};return this.activeRuns.set(o,i),this.executeWorkflow(o,i).catch(e=>{console.error(`Workflow ${o} failed:`,e)}),o}async executeWorkflow(e,t){var n;const r=Date.now();try{const o=await this.getWorkItemContext(t.workItemId,t.projectId),i=await this.buildConstitution(t.projectId,null===(n=t.options)||void 0===n?void 0:n.includeWikiPages);let s;switch(t.workflow){case"specify":s=await this.executeSpecifyWorkflow(o,i,t);break;case"plan":s=await this.executePlanWorkflow(o,i,t);break;case"tasks":s=await this.executeTasksWorkflow(o,i,t);break;default:throw new Error(`Unknown workflow: ${t.workflow}`)}const a=Date.now()-r;await this.saveArtifacts(s.artifacts,t),"tasks"===t.workflow&&s.tasks&&await this.createChildTasks(t.workItemId,s.tasks,t.projectId);const c={success:!0,runId:e,artifacts:s.artifacts,cost:s.cost,duration:a};return this.activeRuns.delete(e),c}catch(t){const n={success:!1,runId:e,duration:Date.now()-r,error:t instanceof Error?t.message:String(t)};return this.activeRuns.delete(e),n}}async getWorkItemContext(e,t){return{id:e,title:`Work Item ${e}`,description:"Sample description",acceptanceCriteria:"Sample acceptance criteria",type:"User Story",state:"New"}}async buildConstitution(e,t){let n="# Project Constitution\n\n";if(t&&t.length>0)for(const r of t)n+=`## ${r}\n\n`,n+=await this.getWikiPageContent(e,r),n+="\n\n";else n+="## Default Guidelines\n\n",n+="- Follow team coding standards\n",n+="- Include comprehensive error handling\n",n+="- Write unit tests for all new functionality\n",n+="- Document public APIs\n";return n}async getWikiPageContent(e,t){return`Content from wiki page: ${t}`}async executeSpecifyWorkflow(e,t,n){return{artifacts:{specifications:[`# Specification for ${e.title}\n\n## Overview\n\nDetailed specification based on constitution and work item requirements.`]},cost:.05,tokens:{input:1200,output:800}}}async executePlanWorkflow(e,t,n){return{artifacts:{plans:[`# Implementation Plan for ${e.title}\n\n## Phases\n\n1. Analysis\n2. Design\n3. Implementation\n4. Testing`]},cost:.03,tokens:{input:800,output:600}}}async executeTasksWorkflow(e,t,n){return{artifacts:{tasks:[{title:"Implement core functionality",description:"Core implementation based on specification",effort:8,type:"Task"},{title:"Add unit tests",description:"Comprehensive test coverage",effort:4,type:"Task"},{title:"Update documentation",description:"API documentation and user guides",effort:2,type:"Task"}]},cost:.04,tokens:{input:1e3,output:500}}}async saveArtifacts(e,t){console.log("Saving artifacts:",e)}async createChildTasks(e,t,n){console.log(`Creating ${t.length} child tasks for work item ${e}`)}generateRunId(){return`run_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}getActiveRuns(){return Array.from(this.activeRuns.keys())}getRunStatus(e){return this.activeRuns.get(e)||null}}},899:(e,t,n)=>{var r,o;r=[t,n(635),n(792)],o=function(e,t,n){"use strict";var r,o=window;o._AzureDevOpsSDKVersion&&console.error("The AzureDevOps SDK is already loaded. Only one version of this module can be loaded in a given document."),o._AzureDevOpsSDKVersion=4.1,e.HostType=void 0,(r=e.HostType||(e.HostType={}))[r.Unknown=0]="Unknown",r[r.Deployment=1]="Deployment",r[r.Enterprise=2]="Enterprise",r[r.Organization=4]="Organization";var i,s,a,c,u,l,p,d,f,h,m="DevOps.HostControl",y=n.channelManager.addChannel(window.parent),g=new Promise(function(e){h=e});function w(e,t){var n,r=window;"function"==typeof r.CustomEvent?n=new r.CustomEvent(e,t):(t=t||{bubbles:!1,cancelable:!1},(n=document.createEvent("CustomEvent")).initCustomEvent(e,t.bubbles,t.cancelable,t.detail)),window.dispatchEvent(n)}function v(){return t.__awaiter(this,void 0,void 0,function(){return t.__generator(this,function(e){return[2,g]})})}function _(e){return"Attempted to call ".concat(e,"() before init() was complete. Wait for init to complete or place within a ready() callback.")}function b(e){f||((f=document.createElement("style")).type="text/css",document.head.appendChild(f));var t=[];if(e)for(var n in e)t.push("--"+n+": "+e[n]);f.innerText=":root { "+t.join("; ")+" } body { color: var(--text-primary-color) }",w("themeApplied",{detail:e})}y.getObjectRegistry().register("DevOps.SdkClient",{dispatchEvent:w}),e.applyTheme=b,e.getAccessToken=function(){return t.__awaiter(this,void 0,void 0,function(){return t.__generator(this,function(e){return[2,y.invokeRemoteMethod("getAccessToken",m).then(function(e){return e.token})]})})},e.getAppToken=function(){return t.__awaiter(this,void 0,void 0,function(){return t.__generator(this,function(e){return[2,y.invokeRemoteMethod("getAppToken",m).then(function(e){return e.token})]})})},e.getConfiguration=function(){if(!u)throw new Error(_("getConfiguration"));return u},e.getContributionId=function(){if(!l)throw new Error(_("getContributionId"));return l},e.getExtensionContext=function(){if(!c)throw new Error(_("getExtensionContext"));return c},e.getHost=function(){if(!d)throw new Error(_("getHost"));return d},e.getPageContext=function(){if(!a)throw new Error(_("getPageContext"));return a},e.getService=function(e){return t.__awaiter(this,void 0,void 0,function(){return t.__generator(this,function(t){return[2,v().then(function(){return y.invokeRemoteMethod("getService","DevOps.ServiceManager",[e])})]})})},e.getTeamContext=function(){if(!i)throw new Error(_("getTeamContext"));return i},e.getUser=function(){if(!p)throw new Error(_("getUser"));return p},e.getWebContext=function(){if(!s)throw new Error(_("getWebContext"));return s},e.init=function(e){return new Promise(function(n){var r=t.__assign(t.__assign({},e),{sdkVersion:4.1});y.invokeRemoteMethod("initialHandshake",m,[r]).then(function(e){if("context"in e){var t=(r=e).context;a=t.pageContext,s=a?a.webContext:void 0,i=s?s.team:void 0,u=r.initialConfig||{},l=r.contributionId,c=t.extension,p=t.user,d=t.host}else{var r;a=(r=e).pageContext,s=a?a.webContext:void 0,i=s?s.team:void 0,u=r.initialConfig||{},l=r.contribution.id,(c=r.extensionContext).id=c.publisherId+"."+c.extensionId}e.themeData&&(b(e.themeData),window.addEventListener("themeChanged",function(e){b(e.detail.data)})),h(),n()})})},e.notifyLoadFailed=function(e){return y.invokeRemoteMethod("notifyLoadFailed",m,[e])},e.notifyLoadSucceeded=function(){return y.invokeRemoteMethod("notifyLoadSucceeded",m)},e.ready=v,e.register=function(e,t){y.getObjectRegistry().register(e,t)},e.resize=function(e,t){var n=document.body;if(n){var r="number"==typeof e?e:n?n.scrollWidth:void 0,o="number"==typeof t?t:n?n.scrollHeight:void 0;y.invokeRemoteMethod("resize",m,[r,o])}},e.sdkVersion=4.1,e.unregister=function(e){y.getObjectRegistry().unregister(e)}}.apply(t,r),void 0===o||(e.exports=o)}}]);
//# sourceMappingURL=common.js.map